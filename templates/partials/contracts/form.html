<div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-md">
  <h2 class="text-xl font-bold mb-6">Criar Contrato de Locação</h2>

  <form
    hx-post="/contracts"
    hx-target="#main-content"
    enctype="multipart/form-data"
  >
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
      <div>
        <label class="block text-sm font-bold mb-1">Inquilino</label>
        <select
          name="tenant_id"
          required
          class="w-full px-3 py-2 border rounded bg-white"
        >
          <option value="">Selecione...</option>
          {% for id, t in tenants.items() %}
          <option value="{{ id }}">{{ t.name }} - {{ t.cpf }}</option>
          {% endfor %}
        </select>
      </div>
      <div>
        <label class="block text-sm font-bold mb-1">Imóvel</label>
        <select
          name="property_id"
          required
          class="w-full px-3 py-2 border rounded bg-white"
        >
          <option value="">Selecione...</option>
          {% for id, p in properties.items() %}
          <option value="{{ id }}">{{ p.property_name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="mb-4">
      <label class="block text-sm font-bold mb-1">Agência / Imobiliária</label>
      <select
        name="real_estate_id"
        required
        class="w-full px-3 py-2 border rounded bg-white"
      >
        <option value="">Selecione...</option>
        {% for id, a in agencies.items() %}
        <option value="{{ id }}">{{ a.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
      <div>
        <label class="block text-sm font-bold mb-1">Valor Aluguel (R$)</label>
        <input
          type="number"
          step="0.01"
          name="rent_amount"
          required
          class="w-full px-3 py-2 border rounded"
        />
      </div>
      <div>
        <label class="block text-sm font-bold mb-1">Nome do Quarto</label>
        <input
          type="text"
          name="room_name"
          placeholder="Ex: Sala 1"
          class="w-full px-3 py-2 border rounded"
        />
      </div>
    </div>

    <div class="p-4 bg-gray-50 rounded border mb-4">
      <h3 class="font-bold text-gray-700 mb-3">Garantia Locatícia</h3>

      <div class="mb-4">
        <label class="block text-sm font-bold mb-1">Tipo de Garantia</label>
        <select
          name="guarantee"
          id="guaranteeType"
          onchange="toggleGuaranteeFields()"
          class="w-full px-3 py-2 border rounded bg-white"
        >
          <option value="caucao">Caução (Depósito)</option>
          <option value="fiador">Fiador</option>
          <option value="seguro_fianca">Seguro Fiança</option>
        </select>
      </div>

      <div id="divCaucao">
        <label class="block text-sm font-bold mb-1"
          >Valor do Depósito (R$)</label
        >
        <input
          type="number"
          step="0.01"
          name="rental_deposit"
          id="inputDeposit"
          value="0"
          class="w-full px-3 py-2 border rounded bg-white"
        />
        <p class="text-xs text-gray-500 mt-1">* Obrigatório para caução</p>
      </div>

      <div id="divFiador" style="display: none">
        <label class="block text-sm font-bold mb-1">Selecione o Fiador</label>
        <div class="flex gap-2">
          <select
            name="guarantee_id"
            id="selectFiador"
            disabled
            class="w-full px-3 py-2 border rounded bg-white"
          >
            <option value="">Selecione um fiador...</option>
            {% for id, g in guarantors.items() %}
            <option value="{{ id }}">
              {{ g.name }} (CPF: {{ g.cpf or g.cnpj }})
            </option>
            {% endfor %}
          </select>
          <button
            type="button"
            hx-get="/guarantors/new"
            hx-target="#main-content"
            class="px-3 py-2 bg-gray-200 rounded text-xs hover:bg-gray-300"
            title="Criar Novo Fiador"
          >
            +
          </button>
        </div>
      </div>

      <div id="divSeguro" style="display: none">
        <label class="block text-sm font-bold mb-1">Selecione o Seguro</label>
        <div class="flex gap-2">
          <select
            name="guarantee_id"
            id="selectSeguro"
            disabled
            class="w-full px-3 py-2 border rounded bg-white"
          >
            <option value="">Selecione a apólice...</option>
            {% for id, b in bail_insurances.items() %}
            <option value="{{ id }}">
              {{ b.insurance_company }} - R$ {{ b.value }}
            </option>
            {% endfor %}
          </select>
          <button
            type="button"
            hx-get="/bail_insurances/new"
            hx-target="#main-content"
            class="px-3 py-2 bg-gray-200 rounded text-xs hover:bg-gray-300"
            title="Criar Novo Seguro"
          >
            +
          </button>
        </div>
      </div>
    </div>

    <div class="mb-6">
      <label class="block text-sm font-bold mb-1"
        >Arquivo do Contrato (PDF)</label
      >
      <input
        type="file"
        name="file_path"
        class="w-full text-sm text-gray-500"
      />
    </div>

    <div class="flex justify-end gap-3">
      <button
        type="button"
        hx-get="/contracts"
        hx-target="#main-content"
        class="px-4 py-2 border rounded"
      >
        Cancelar
      </button>
      <button
        type="submit"
        class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700"
      >
        Criar Contrato
      </button>
    </div>
  </form>
</div>
